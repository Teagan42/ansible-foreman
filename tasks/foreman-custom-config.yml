---
- name: "Default Organization"
  theforeman.foreman.foreman_organization:
    server_url: "http://{{ foreman_proxy_bind_host }}"
    username: "{{ foreman_admin_user }}"
    password: "{{ foreman_admin_password }}"
    name: "Default Organization"
    state: present

- name: "Default Location"
  theforeman.foreman.foreman_location:
    server_url: "http://{{ foreman_proxy_bind_host }}"
    username: "{{ foreman_admin_user }}"
    password: "{{ foreman_admin_password }}"
    name: "Default Location"
    organizations:
      - "Default Organization"
    state: present

- name: Update Foreman Settings
  theforeman.foreman.foreman_setting:
    server_url: "http://{{ foreman_proxy_bind_host }}"
    username: "{{ foreman_admin_user }}"
    password: "{{ foreman_admin_password }}"
    name: "{{ item.name }}"
    value: "{{ item.value }}"
  loop: "{{ foreman_default_settings }}"
  when:
    - foreman_default_settings is defined
    - foreman_default_settings != None

- name: Configure Additional Foreman Settings
  theforeman.foreman.foreman_setting:
    server_url: "http://{{ foreman_proxy_bind_host }}"
    username: "{{ foreman_admin_user }}"
    password: "{{ foreman_admin_password }}"
    name: "{{ item.name }}"
    value: "{{ item.value }}"
  loop: "{{ foreman_extra_settings }}"
  when:
    - foreman_extra_settings is defined
    - foreman_extra_settings != None

- name: "Update global parameters"
  theforeman.foreman.foreman_global_parameter:
    name: "{{ item.name }}"
    value: "{{ item.value }}"
    parameter_type: "{{ item.parameter_type | default('string') }}"
    server_url: "http://{{ foreman_proxy_bind_host }}"
    username: "{{ foreman_admin_user }}"
    password: "{{ foreman_admin_password }}"
    state: present_with_defaults
  loop: "{{ foreman_global_parameters }}"
  when:
    - foreman_global_parameters is defined
    - foreman_global_parameters != None
